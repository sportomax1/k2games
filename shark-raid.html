<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Shark Raid: Deep Sea - K2 games</title>
    <style>
        :root {
            --sky: #7dd3fc;
            --water-surface: #0ea5e9;
            --water-deep: #1e40af;
            --sand: #fef08a;
            --accent: #f43f5e;
            --panel: rgba(15, 23, 42, 0.9);
            --text: #f8fafc;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; user-select: none; touch-action: none; }
        
        body {
            background-color: #020617;
            color: var(--text);
            font-family: 'Segoe UI', system-ui, sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        nav {
            padding: 0.75rem 1.5rem;
            background: rgba(0,0,0,0.4);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .logo { font-weight: 900; font-size: 1.3rem; background: linear-gradient(to right, var(--sky), #fff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .back-link { color: #94a3b8; text-decoration: none; font-weight: bold; font-size: 0.9rem; }

        #game-layout {
            flex: 1;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        canvas {
            background: #fff;
            display: block;
            box-shadow: 0 0 100px rgba(0,0,0,0.8);
            max-width: 100%;
            max-height: 100%;
        }

        .hud {
            position: absolute;
            top: 15px;
            left: 15px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            pointer-events: none;
        }

        .stat-card {
            background: var(--panel);
            backdrop-filter: blur(12px);
            padding: 10px 15px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            display: flex;
            flex-direction: column;
            min-width: 130px;
        }

        .stat-label { font-size: 0.55rem; text-transform: uppercase; letter-spacing: 1px; color: #94a3b8; }
        .stat-val { font-size: 1.4rem; font-weight: 900; font-family: monospace; }
        .stat-val.shark { color: var(--accent); }
        .stat-val.boat { color: var(--sky); }

        .hunger-bar-container {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 200px;
            background: var(--panel);
            padding: 12px;
            border-radius: 50px;
            border: 1px solid rgba(255,255,255,0.1);
            text-align: center;
        }

        #hunger-fill {
            height: 10px;
            background: linear-gradient(90deg, #ef4444, #22c55e);
            border-radius: 5px;
            width: 100%;
            margin-top: 4px;
        }

        #mobile-controls {
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            padding: 0 30px;
            display: none;
            justify-content: space-between;
            align-items: flex-end;
            pointer-events: none;
            z-index: 50;
        }

        @media (max-width: 900px) { #mobile-controls { display: flex; } }

        .virtual-pad {
            width: 120px; height: 120px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            position: relative;
            pointer-events: auto;
            border: 2px solid rgba(255,255,255,0.2);
        }
        .pad-knob {
            width: 45px; height: 45px;
            background: #fff; border-radius: 50%;
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 4px 15px rgba(0,0,0,0.4);
        }

        .boost-btn {
            width: 75px; height: 75px;
            background: var(--accent);
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            color: white; font-weight: 900; font-size: 0.75rem;
            pointer-events: auto;
            box-shadow: 0 10px 25px rgba(244, 63, 94, 0.4);
        }
        .boost-btn:active { transform: scale(0.9); filter: brightness(1.2); }

        #overlay {
            position: absolute; inset: 0;
            background: rgba(2, 6, 23, 0.95);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 200; text-align: center;
        }

        .btn-large {
            background: var(--water-surface); color: white; border: none; padding: 1rem 2.5rem;
            border-radius: 50px; font-weight: 800; cursor: pointer; margin-top: 1.5rem;
            font-size: 1.2rem; box-shadow: 0 10px 25px rgba(14, 165, 233, 0.4);
        }
    </style>
</head>
<body>
    <nav>
        <div class="logo">SHARK RAID</div>
        <a href="index.html" class="back-link">‚Üê EXIT HUB</a>
    </nav>

    <div id="game-layout">
        <canvas id="gameCanvas" width="1000" height="750"></canvas>

        <div class="hud">
            <div class="stat-card">
                <span class="stat-label">Shark (You)</span>
                <span id="score-shark" class="stat-val shark">0</span>
            </div>
            <div class="stat-card">
                <span class="stat-label">Boat (Fisherman)</span>
                <span id="score-boat" class="stat-val boat">0</span>
            </div>
        </div>

        <div class="hunger-bar-container">
            <span class="stat-label">Hunger Level</span>
            <div id="hunger-fill"></div>
        </div>

        <div id="mobile-controls">
            <div class="virtual-pad" id="joy-base">
                <div class="pad-knob" id="joy-thumb"></div>
            </div>
            <div class="boost-btn" id="btn-boost">BOOST</div>
        </div>

        <div id="overlay">
            <h1 style="font-size: 3.5rem; background: linear-gradient(to bottom, #fff, var(--sky)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">SHARK RAID</h1>
            <p style="opacity: 0.7; margin-top: 10px;">DON'T LET THE FISHERMAN STEAL YOUR MEAL.</p>
            <p id="final-stats" style="margin-top: 20px; font-weight: bold; color: var(--accent);"></p>
            <button class="btn-large" id="start-btn" onclick="game.start()">START HUNT</button>
        </div>
    </div>

    <script>
        class SharkRaid {
            constructor() {
                this.canvas = document.getElementById('gameCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.width = 1000;
                this.height = 750;

                this.shark = { x: 500, y: 500, r: 35, angle: 0, speed: 0, maxSpeed: 6, hunger: 100, anim: 0 };
                this.boat = { x: 500, y: 120, vx: 2.5, hookY: 0, hookActive: false };
                this.fish = [];
                this.bubbles = [];
                this.whales = [];
                this.particles = [];
                this.score = { shark: 0, boat: 0 };
                this.isPlaying = false;
                this.keys = {};
                this.joy = { active: false, x: 0, y: 0 };
                this.boosting = false;

                this.setupControls();
                this.animate();
            }

            setupControls() {
                window.onkeydown = (e) => this.keys[e.code] = true;
                window.onkeyup = (e) => this.keys[e.code] = false;

                const base = document.getElementById('joy-base');
                const thumb = document.getElementById('joy-thumb');
                const handleJoy = (e) => {
                    if(!this.joy.active) return;
                    const rect = base.getBoundingClientRect();
                    const touch = e.touches ? e.touches[0] : e;
                    const dx = touch.clientX - (rect.left + rect.width/2);
                    const dy = touch.clientY - (rect.top + rect.height/2);
                    const dist = Math.min(50, Math.hypot(dx, dy));
                    const angle = Math.atan2(dy, dx);
                    this.joy.x = (Math.cos(angle) * dist) / 50;
                    this.joy.y = (Math.sin(angle) * dist) / 50;
                    thumb.style.transform = `translate(calc(-50% + ${Math.cos(angle)*dist}px), calc(-50% + ${Math.sin(angle)*dist}px))`;
                };
                base.addEventListener('touchstart', (e) => { this.joy.active = true; handleJoy(e); e.preventDefault(); }, {passive: false});
                window.addEventListener('touchmove', (e) => handleJoy(e), {passive: false});
                window.addEventListener('touchend', () => {
                    this.joy.active = false; this.joy.x = 0; this.joy.y = 0;
                    thumb.style.transform = 'translate(-50%, -50%)';
                });

                const boostBtn = document.getElementById('btn-boost');
                boostBtn.addEventListener('touchstart', (e) => { this.boosting = true; e.preventDefault(); });
                boostBtn.addEventListener('touchend', () => this.boosting = false);
            }

            start() {
                this.score = { shark: 0, boat: 0 };
                this.shark = { x: 500, y: 500, r: 35, angle: 0, speed: 0, maxSpeed: 6, hunger: 100, anim: 0 };
                this.fish = [];
                for(let i=0; i<15; i++) this.spawnFish(true);
                this.whales = [];
                this.bubbles = [];
                this.particles = [];
                this.isPlaying = true;
                document.getElementById('overlay').style.display = 'none';
            }

            spawnFish(anywhere = false) {
                const side = Math.random() > 0.5 ? 1 : -1;
                this.fish.push({
                    x: anywhere ? Math.random() * this.width : (side === 1 ? -50 : this.width + 50),
                    y: 250 + Math.random() * 450,
                    r: 12 + Math.random() * 10,
                    vx: side * (1 + Math.random() * 3),
                    vy: (Math.random() - 0.5) * 1,
                    type: Math.random() > 0.8 ? 'gold' : 'blue'
                });
            }

            spawnWhale() {
                if (Math.random() < 0.005) {
                    const side = Math.random() > 0.5 ? 1 : -1;
                    this.whales.push({
                        x: side === 1 ? -200 : this.width + 200,
                        y: 300 + Math.random() * 300,
                        r: 70,
                        vx: side * 2.5
                    });
                }
            }

            update() {
                if (!this.isPlaying) return;

                let dx = 0, dy = 0;
                if (this.keys['ArrowUp'] || this.keys['KeyW']) dy = -1;
                if (this.keys['ArrowDown'] || this.keys['KeyS']) dy = 1;
                if (this.keys['ArrowLeft'] || this.keys['KeyA']) dx = -1;
                if (this.keys['ArrowRight'] || this.keys['KeyD']) dx = 1;
                if (this.joy.active) { dx = this.joy.x; dy = this.joy.y; }

                const speedLimit = (this.keys['ShiftLeft'] || this.boosting) ? this.shark.maxSpeed * 2 : this.shark.maxSpeed;
                if (dx !== 0 || dy !== 0) {
                    this.shark.angle = Math.atan2(dy, dx);
                    this.shark.speed = Math.min(speedLimit, this.shark.speed + 0.3);
                    this.shark.anim += 0.2;
                } else {
                    this.shark.speed *= 0.94;
                }

                this.shark.x += Math.cos(this.shark.angle) * this.shark.speed;
                this.shark.y += Math.sin(this.shark.angle) * this.shark.speed;

                if (this.shark.x < -50) this.shark.x = this.width + 50;
                if (this.shark.x > this.width + 50) this.shark.x = -50;
                if (this.shark.y < 200) this.shark.y = 200;
                if (this.shark.y > this.height - 50) this.shark.y = this.height - 50;

                this.boat.x += this.boat.vx;
                if (this.boat.x < 150 || this.boat.x > this.width - 150) this.boat.vx *= -1;

                if (!this.boat.hookActive && Math.random() < 0.015) {
                    this.boat.hookActive = true;
                    this.boat.hookY = 0;
                }

                if (this.boat.hookActive) {
                    this.boat.hookY += 7;
                    if (this.boat.hookY > 500) this.boat.hookActive = false;
                }

                this.fish.forEach((f, i) => {
                    f.x += f.vx; f.y += f.vy;
                    if (f.x < -100 || f.x > this.width + 100) { this.fish.splice(i, 1); this.spawnFish(); return; }

                    const dShark = Math.hypot(this.shark.x - f.x, this.shark.y - f.y);
                    if (dShark < this.shark.r + f.r) {
                        this.score.shark += f.type === 'gold' ? 50 : 10;
                        this.shark.hunger = Math.min(100, this.shark.hunger + 15);
                        this.fish.splice(i, 1);
                        this.spawnFish();
                        this.spawnParticles(f.x, f.y, '#f43f5e', 12);
                    }

                    if (this.boat.hookActive) {
                        const dHook = Math.hypot(this.boat.x - f.x, (this.boat.y + this.boat.hookY) - f.y);
                        if (dHook < 30) {
                            this.score.boat += 20;
                            this.fish.splice(i, 1);
                            this.spawnFish();
                            this.boat.hookActive = false;
                            this.spawnParticles(f.x, f.y, '#fff', 8);
                        }
                    }
                });

                this.spawnWhale();
                this.whales.forEach((w, i) => {
                    w.x += w.vx;
                    if (Math.hypot(this.shark.x - w.x, this.shark.y - w.y) < this.shark.r + w.r) {
                        this.shark.hunger -= 1;
                        this.spawnParticles(this.shark.x, this.shark.y, '#fff', 2);
                    }
                    if (w.x < -300 || w.x > this.width + 300) this.whales.splice(i, 1);
                });

                if (Math.random() < 0.1) this.bubbles.push({ x: Math.random()*this.width, y: this.height + 20, v: 1.5 + Math.random()*2, r: 3 + Math.random()*6 });
                this.bubbles.forEach((b, i) => { b.y -= b.v; if (b.y < 200) this.bubbles.splice(i, 1); });

                this.shark.hunger -= 0.07;
                if (this.shark.hunger <= 0) this.gameOver();

                this.updateUI();
            }

            spawnParticles(x, y, color, count) {
                for(let i=0; i<count; i++) {
                    this.particles.push({ x, y, vx: (Math.random()-0.5)*12, vy: (Math.random()-0.5)*12, life: 1, color });
                }
            }

            updateUI() {
                const scoreShark = document.getElementById('score-shark');
                const scoreBoat = document.getElementById('score-boat');
                const hungerFill = document.getElementById('hunger-fill');
                if (scoreShark) scoreShark.textContent = this.score.shark;
                if (scoreBoat) scoreBoat.textContent = this.score.boat;
                if (hungerFill) {
                    hungerFill.style.width = this.shark.hunger + '%';
                    hungerFill.style.background = this.shark.hunger < 30 ? '#ef4444' : '#22c55e';
                }
            }

            gameOver() {
                this.isPlaying = false;
                document.getElementById('overlay').style.display = 'flex';
                document.getElementById('start-btn').textContent = "TRY AGAIN";
                const result = this.score.shark > this.score.boat ? "YOU OUT-HUNTED THE BOAT!" : "THE FISHERMAN WON...";
                document.getElementById('final-stats').textContent = `${result} Score: ${this.score.shark}`;
            }

            draw() {
                const ctx = this.ctx;
                ctx.clearRect(0, 0, this.width, this.height);

                ctx.fillStyle = '#7dd3fc'; ctx.fillRect(0, 0, this.width, 200);
                
                // Sun
                ctx.fillStyle = '#fef08a';
                ctx.beginPath(); ctx.arc(100, 80, 40, 0, Math.PI*2); ctx.fill();
                ctx.shadowBlur = 30; ctx.shadowColor = '#fef08a';
                ctx.beginPath(); ctx.arc(100, 80, 35, 0, Math.PI*2); ctx.fill();
                ctx.shadowBlur = 0;

                const water = ctx.createLinearGradient(0, 200, 0, this.height);
                water.addColorStop(0, '#0ea5e9'); water.addColorStop(1, '#020617');
                ctx.fillStyle = water; ctx.fillRect(0, 200, this.width, this.height - 200);

                ctx.strokeStyle = 'rgba(255,255,255,0.2)';
                this.bubbles.forEach(b => { ctx.beginPath(); ctx.arc(b.x, b.y, b.r, 0, Math.PI*2); ctx.stroke(); });

                this.particles.forEach((p, i) => {
                    ctx.globalAlpha = p.life; ctx.fillStyle = p.color;
                    ctx.beginPath(); ctx.arc(p.x, p.y, 3, 0, Math.PI*2); ctx.fill();
                    p.x += p.vx; p.y += p.vy; p.life -= 0.03;
                    if (p.life <= 0) this.particles.splice(i, 1);
                });
                ctx.globalAlpha = 1;

                ctx.save();
                ctx.translate(this.boat.x, this.boat.y);
                // Hull
                ctx.fillStyle = '#f8fafc';
                ctx.beginPath();
                ctx.moveTo(-60, 0); ctx.lineTo(60, 0); ctx.lineTo(45, 25); ctx.lineTo(-45, 25); ctx.closePath();
                ctx.fill();
                ctx.strokeStyle = '#cbd5e1'; ctx.lineWidth = 2; ctx.stroke();
                // Cabin
                ctx.fillStyle = '#334155';
                ctx.fillRect(-20, -25, 40, 25);
                // Fisherman
                ctx.font = '30px Arial';
                ctx.fillText('üë®‚Äçüåæ', -15, -25);
                // Hook
                if (this.boat.hookActive) {
                    ctx.strokeStyle = '#000'; ctx.lineWidth = 1.5;
                    ctx.beginPath(); ctx.moveTo(30, 10); ctx.lineTo(30, this.boat.hookY); ctx.stroke();
                    ctx.font = '24px Arial'; ctx.fillText('ü™ù', 18, this.boat.hookY + 15);
                }
                ctx.restore();

                this.fish.forEach(f => {
                    ctx.save(); ctx.translate(f.x, f.y);
                    if (f.vx < 0) ctx.scale(-1, 1);
                    ctx.font = `${f.r * 2.5}px Arial`;
                    ctx.fillText(f.type === 'gold' ? 'üê†' : 'üêü', -f.r, f.r/2);
                    ctx.restore();
                });

                this.whales.forEach(w => {
                    ctx.save(); ctx.translate(w.x, w.y);
                    if (w.vx < 0) ctx.scale(-1, 1);
                    ctx.font = '100px Arial';
                    ctx.fillText('üêã', -50, 40);
                    ctx.restore();
                });

                ctx.save();
                ctx.translate(this.shark.x, this.shark.y);
                ctx.rotate(this.shark.angle);
                const wobble = Math.sin(this.shark.anim) * 0.15;
                ctx.rotate(wobble);
                ctx.font = '90px Arial'; ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
                ctx.fillText('ü¶à', 0, 0);
                ctx.restore();
            }

            animate() {
                this.update();
                this.draw();
                requestAnimationFrame(() => this.animate());
            }
        }

        const game = new SharkRaid();
    </script>
</body>
</html>