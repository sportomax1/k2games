<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jetpack Runner</title>
    <style>
        body { margin: 0; background: #1e293b; color: white; font-family: sans-serif; overflow: hidden; }
        canvas { display: block; background: #0f172a; }
        .ui { position: absolute; top: 20px; left: 20px; font-size: 1.5rem; text-shadow: 2px 2px 0 black; pointer-events: none; }
        .back { position: absolute; bottom: 20px; left: 20px; color: #38bdf8; text-decoration: none; font-weight: bold; background: rgba(0,0,0,0.5); padding: 10px 20px; border-radius: 8px; }
    </style>
</head>
<body>
    <div class="ui">Distance: <span id="dist">0</span>m | Coins: <span id="coins">0</span></div>
    <canvas id="game"></canvas>
    <a href="index.html" class="back">‚Üê HUB</a>

    <script>
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let player = { x: 100, y: 300, vy: 0, w: 40, h: 60 };
        let obstacles = [], coins = [], particles = [];
        let score = 0, distance = 0, gameFrame = 0;
        let isThrusting = false;

        function spawn() {
            if (gameFrame % 100 === 0) {
                let y = Math.random() * (canvas.height - 100);
                obstacles.push({ x: canvas.width, y, w: 150, h: 20 });
            }
            if (gameFrame % 60 === 0) {
                coins.push({ x: canvas.width, y: Math.random() * (canvas.height - 50), r: 10 });
            }
        }

        function createExhaust(x, y) {
            particles.push({
                x, y,
                vx: -5 - Math.random() * 5,
                vy: 2 + Math.random() * 5,
                life: 1,
                size: 5 + Math.random() * 10
            });
        }

        function update() {
            gameFrame++;
            distance += 0.1;
            document.getElementById('dist').textContent = Math.floor(distance);

            // Physics
            if (isThrusting) {
                player.vy -= 0.6;
                createExhaust(player.x + 5, player.y + player.h);
            } else {
                player.vy += 0.4;
            }
            player.y += player.vy;

            // Bounds
            if (player.y < 0) { player.y = 0; player.vy = 0; }
            if (player.y > canvas.height - player.h) { player.y = canvas.height - player.h; player.vy = 0; }

            // Obstacles
            obstacles.forEach((o, i) => {
                o.x -= 8;
                if (o.x < -200) obstacles.splice(i, 1);
                // Collision
                if (player.x < o.x + o.w && player.x + player.w > o.x && player.y < o.y + o.h && player.y + player.h > o.y) {
                    alert("Crashed! Distance: " + Math.floor(distance) + "m");
                    location.reload();
                }
            });

            // Coins
            coins.forEach((c, i) => {
                c.x -= 8;
                if (c.x < -50) coins.splice(i, 1);
                if (Math.hypot(player.x + 20 - c.x, player.y + 30 - c.y) < 40) {
                    coins.splice(i, 1);
                    score += 5;
                    document.getElementById('coins').textContent = score;
                }
            });

            particles.forEach((p, i) => {
                p.x += p.vx; p.y += p.vy; p.life -= 0.05;
                if (p.life <= 0) particles.splice(i, 1);
            });

            spawn();
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Particles
            particles.forEach(p => {
                ctx.fillStyle = `rgba(255, ${100 + p.life * 155}, 0, ${p.life})`;
                ctx.beginPath(); ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2); ctx.fill();
            });

            // Player
            ctx.fillStyle = "#38bdf8";
            ctx.fillRect(player.x, player.y, player.w, player.h);
            ctx.fillStyle = "#fff";
            ctx.fillRect(player.x + 25, player.y + 10, 10, 10); // Goggle

            // Obstacles (Lasers)
            ctx.fillStyle = "#ef4444";
            ctx.shadowBlur = 15; ctx.shadowColor = "#ef4444";
            obstacles.forEach(o => ctx.fillRect(o.x, o.y, o.w, o.h));
            ctx.shadowBlur = 0;

            // Coins
            ctx.fillStyle = "#fbbf24";
            coins.forEach(c => {
                ctx.beginPath(); ctx.arc(c.x, c.y, c.r, 0, Math.PI * 2); ctx.fill();
            });

            update();
            requestAnimationFrame(draw);
        }

        window.onkeydown = (e) => { if (e.code === 'Space') isThrusting = true; };
        window.onkeyup = (e) => { if (e.code === 'Space') isThrusting = false; };
        window.onmousedown = () => isThrusting = true;
        window.onmouseup = () => isThrusting = false;

        draw();
    </script>
</body>
</html>