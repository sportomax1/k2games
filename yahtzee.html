<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yahtzee Pro</title>
    <style>
        :root { --p: #2563eb; --bg: #f8fafc; }
        body { font-family: sans-serif; background: #1e293b; color: white; display: flex; flex-direction: column; align-items: center; padding: 20px; margin: 0; }
        .game-layout { display: flex; gap: 30px; flex-wrap: wrap; justify-content: center; }
        .dice-area { display: flex; gap: 10px; margin: 20px 0; }
        .die { width: 60px; height: 60px; background: white; color: #1e293b; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: bold; cursor: pointer; border: 4px solid transparent; }
        .held { border-color: #10b981; background: #ecfdf5; }
        .score-card { background: white; color: #1e293b; padding: 15px; border-radius: 12px; width: 280px; }
        .score-row { display: flex; justify-content: space-between; padding: 8px; border-bottom: 1px solid #e2e8f0; cursor: pointer; }
        .score-row:hover:not(.used) { background: #f1f5f9; }
        .used { color: #94a3b8; cursor: default; }
        .btn { padding: 12px 24px; background: var(--p); color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1.1rem; }
        .back { text-decoration: none; color: #94a3b8; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>üé≤ Yahtzee üé≤</h1>
    <div id="status" style="margin-bottom:10px">Round 1/13</div>
    
    <div class="dice-area" id="dice"></div>
    <div style="margin-bottom:20px">
        <button class="btn" id="rollBtn" onclick="roll()">Roll Dice (3 left)</button>
    </div>

    <div class="game-layout">
        <div class="score-card">
            <h3>Player Score</h3>
            <div id="playerScores"></div>
            <div style="margin-top:10px; font-weight:bold; font-size:1.2rem">Total: <span id="pTotal">0</span></div>
        </div>
        <div class="score-card">
            <h3>AI Score</h3>
            <div id="aiScores"></div>
            <div style="margin-top:10px; font-weight:bold; font-size:1.2rem">Total: <span id="aiTotal">0</span></div>
        </div>
    </div>
    <a href="index.html" class="back">‚Üê Back to Hub</a>

    <script>
        let dice = [1,1,1,1,1], held = [false,false,false,false,false], rolls = 3, round = 1;
        let pScores = {}, aiScores = {};
        const cats = {
            ones: "Ones", twos: "Twos", threes: "Threes", fours: "Fours", fives: "Fives", sixes: "Sixes",
            tok: "3 of a Kind", fok: "4 of a Kind", fh: "Full House", ss: "Sm Straight", ls: "Lg Straight", y: "Yahtzee", c: "Chance"
        };

        function roll() {
            if (rolls <= 0) return;
            for (let i=0; i<5; i++) if (!held[i]) dice[i] = Math.floor(Math.random()*6)+1;
            rolls--;
            render();
        }

        function toggleHold(i) {
            if (rolls < 3) { held[i] = !held[i]; render(); }
        }

        function getScore(cat, vals) {
            const counts = {}; vals.forEach(v => counts[v] = (counts[v]||0)+1);
            const sum = vals.reduce((a,b)=>a+b, 0);
            const freq = Object.values(counts);
            const unique = [...new Set(vals)].sort();
            
            const hasS = (len) => {
                let count=1, max=1;
                for(let i=0; i<unique.length-1; i++) {
                    if(unique[i+1] === unique[i]+1) count++; else count=1;
                    max = Math.max(max, count);
                }
                return max >= len;
            };

            switch(cat) {
                case 'ones': return (counts[1]||0)*1;
                case 'twos': return (counts[2]||0)*2;
                case 'threes': return (counts[3]||0)*3;
                case 'fours': return (counts[4]||0)*4;
                case 'fives': return (counts[5]||0)*5;
                case 'sixes': return (counts[6]||0)*6;
                case 'tok': return freq.some(f => f>=3) ? sum : 0;
                case 'fok': return freq.some(f => f>=4) ? sum : 0;
                case 'fh': return freq.includes(3) && freq.includes(2) ? 25 : 0;
                case 'ss': return hasS(4) ? 30 : 0;
                case 'ls': return hasS(5) ? 40 : 0;
                case 'y': return freq.includes(5) ? 50 : 0;
                case 'c': return sum;
            }
        }

        function select(cat) {
            if (pScores[cat] !== undefined || rolls === 3) return;
            pScores[cat] = getScore(cat, dice);
            aiTurn();
        }

        function aiTurn() {
            round++;
            if (round > 13) {
                const pt = Object.values(pScores).reduce((a,b)=>a+b,0);
                const at = Object.values(aiScores).reduce((a,b)=>a+b,0);
                alert(`Game Over! Player: ${pt} | AI: ${at}`);
                location.reload();
                return;
            }
            // Simple AI
            const available = Object.keys(cats).filter(k => aiScores[k] === undefined);
            const aiDice = Array(5).fill(0).map(()=>Math.floor(Math.random()*6)+1);
            const bestCat = available.sort((a,b) => getScore(b, aiDice) - getScore(a, aiDice))[0];
            aiScores[bestCat] = getScore(bestCat, aiDice);
            
            rolls = 3; dice = [1,1,1,1,1]; held = [false,false,false,false,false];
            render();
        }

        function render() {
            const diceEl = document.getElementById('dice');
            diceEl.innerHTML = '';
            dice.forEach((d, i) => {
                const div = document.createElement('div');
                div.className = 'die' + (held[i] ? ' held' : '');
                div.textContent = d;
                div.onclick = () => toggleHold(i);
                diceEl.appendChild(div);
            });

            const pArea = document.getElementById('playerScores');
            pArea.innerHTML = '';
            let pTotal = 0;
            for (let k in cats) {
                const val = pScores[k];
                if (val !== undefined) pTotal += val;
                const div = document.createElement('div');
                div.className = 'score-row' + (val !== undefined ? ' used' : '');
                div.innerHTML = `<span>${cats[k]}</span><span>${val !== undefined ? val : getScore(k, dice)}</span>`;
                div.onclick = () => select(k);
                pArea.appendChild(div);
            }
            document.getElementById('pTotal').textContent = pTotal;

            const aiArea = document.getElementById('aiScores');
            aiArea.innerHTML = '';
            let aiTotal = 0;
            for (let k in cats) {
                const val = aiScores[k];
                if (val !== undefined) aiTotal += val;
                const div = document.createElement('div');
                div.className = 'score-row used';
                div.innerHTML = `<span>${cats[k]}</span><span>${val !== undefined ? val : '-'}</span>`;
                aiArea.appendChild(div);
            }
            document.getElementById('aiTotal').textContent = aiTotal;

            document.getElementById('rollBtn').textContent = `Roll Dice (${rolls} left)`;
            document.getElementById('status').textContent = `Round ${round}/13`;
        }
        render();
    </script>
</body>
</html>
