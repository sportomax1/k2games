<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Roulette Royale - K2 games</title>
    <style>
        :root {
            --bg: #0f172a;
            --felt: #064e3b;
            --gold: #fbbf24;
            --red: #ef4444;
            --black: #1e293b;
            --glass: rgba(255, 255, 255, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; touch-action: none; user-select: none; }
        
        body {
            background-color: var(--bg);
            color: white;
            font-family: 'Segoe UI', system-ui, sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        nav {
            height: 60px;
            padding: 0 1.5rem;
            background: rgba(0,0,0,0.4);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .logo { font-weight: 900; font-size: 1.2rem; color: var(--gold); letter-spacing: -0.5px; }
        .back-link { color: #94a3b8; text-decoration: none; font-weight: bold; font-size: 0.9rem; }

        #game-layout {
            height: calc(100vh - 60px);
            display: grid;
            grid-template-rows: 40% 1fr; /* Wheel top, Table bottom */
            gap: 0;
            overflow: hidden;
        }

        @media (min-width: 900px) {
            #game-layout { grid-template-rows: none; grid-template-columns: 1fr 350px; }
        }

        /* Wheel Section */
        #wheel-container {
            position: relative;
            background: radial-gradient(circle, #334155 0%, #0f172a 70%);
            border-bottom: 4px solid #475569;
            box-shadow: inset 0 0 50px rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        @media (min-width: 900px) {
            #wheel-container { border-bottom: none; border-right: 4px solid #475569; }
        }

        canvas {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        /* Betting Table */
        #table-container {
            background: var(--felt);
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            overflow: hidden; /* Prevent body scroll */
        }

        .info-bar {
            display: flex; justify-content: space-between;
            font-weight: bold; font-size: 0.9rem;
            background: rgba(0,0,0,0.3); padding: 8px 15px; border-radius: 8px;
        }

        /* Scrollable Betting Grid */
        #betting-area {
            flex: 1;
            overflow-y: auto;
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 5px;
        }

        .bet-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 4px;
        }

        .bet-spot {
            background: transparent;
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 12px 2px;
            text-align: center;
            font-weight: bold;
            cursor: pointer;
            position: relative;
            font-size: 0.8rem;
            display: flex; align-items: center; justify-content: center;
        }
        .bet-spot:hover { background: rgba(255,255,255,0.1); }
        .bet-spot.red { background: rgba(239, 68, 68, 0.3); }
        .bet-spot.black { background: rgba(30, 41, 59, 0.5); }
        .bet-spot.green { background: rgba(34, 197, 94, 0.3); grid-column: span 3; }
        
        .bet-row { display: grid; grid-template-columns: 1fr 1fr; gap: 4px; margin-bottom: 4px; }

        /* Controls */
        #controls {
            display: flex;
            flex-direction: column;
            gap: 8px;
            background: rgba(0,0,0,0.2);
            padding: 10px;
            border-radius: 10px;
        }

        .btn-spin {
            background: var(--gold);
            color: #000;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-weight: 900;
            font-size: 1.1rem;
            cursor: pointer;
            text-transform: uppercase;
            box-shadow: 0 5px 15px rgba(251, 191, 36, 0.3);
        }
        .btn-spin:disabled { opacity: 0.5; cursor: not-allowed; }

        .chip-selector {
            display: flex; gap: 10px; justify-content: center;
        }
        .chip-opt {
            width: 35px; height: 35px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.5);
            display: flex; align-items: center; justify-content: center;
            font-size: 0.6rem; font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
        }
        .chip-opt.selected { transform: scale(1.2); border-color: white; box-shadow: 0 0 10px white; }
        .chip-10 { background: #3b82f6; }
        .chip-50 { background: #ef4444; }
        .chip-100 { background: #000; border-color: var(--gold); }

        #result-overlay {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9);
            padding: 20px 40px;
            border-radius: 20px;
            text-align: center;
            border: 2px solid var(--gold);
            display: none;
            z-index: 200;
        }

        .btn-small { padding: 5px 10px; background: transparent; border: 1px solid #999; color: #ccc; border-radius: 5px; cursor: pointer; font-size: 0.7rem; }
    </style>
</head>
<body>
    <nav>
        <div class="logo">K2 ROULETTE</div>
        <a href="index.html" class="back-link">‚Üê HUB</a>
    </nav>

    <div id="game-layout">
        <div id="wheel-container">
            <canvas id="wheelCanvas"></canvas>
            <div id="result-overlay">
                <h1 id="res-num" style="font-size: 4rem; margin: 0; color: var(--gold);">0</h1>
                <p id="res-win" style="font-size: 1.5rem; color: #4ade80;">WIN: 500</p>
            </div>
        </div>

        <div id="table-container">
            <div class="info-bar">
                <span>BAL: <span id="balance">1000</span></span>
                <span>BET: <span id="current-bet">0</span></span>
            </div>

            <div id="betting-area">
                <!-- Outside Bets -->
                <div class="bet-row">
                    <div class="bet-spot red" onclick="game.placeBet('RED')">RED</div>
                    <div class="bet-spot black" onclick="game.placeBet('BLACK')">BLACK</div>
                </div>
                <div class="bet-row">
                    <div class="bet-spot" onclick="game.placeBet('EVEN')">EVEN</div>
                    <div class="bet-spot" onclick="game.placeBet('ODD')">ODD</div>
                </div>
                <div class="bet-grid" style="margin-bottom: 10px;">
                    <div class="bet-spot" onclick="game.placeBet('1st 12')">1st 12</div>
                    <div class="bet-spot" onclick="game.placeBet('2nd 12')">2nd 12</div>
                    <div class="bet-spot" onclick="game.placeBet('3rd 12')">3rd 12</div>
                </div>

                <!-- Numbers -->
                <div class="bet-grid" id="numbers-grid">
                    <div class="bet-spot green" onclick="game.placeBet('0')">0</div>
                    <!-- 1-36 -->
                </div>
            </div>

            <div id="controls">
                <div class="chip-selector">
                    <div class="chip-opt chip-10 selected" onclick="game.setChip(10)">10</div>
                    <div class="chip-opt chip-50" onclick="game.setChip(50)">50</div>
                    <div class="chip-opt chip-100" onclick="game.setChip(100)">100</div>
                </div>
                <div style="display:flex; gap:10px;">
                    <button class="btn-spin" id="spin-btn" style="flex:1" onclick="game.spin()">SPIN</button>
                    <button class="btn-small" onclick="game.clearBets()">CLEAR</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const NUMBERS = [0, 32, 15, 19, 4, 21, 2, 25, 17, 34, 6, 27, 13, 36, 11, 30, 8, 23, 10, 5, 24, 16, 33, 1, 20, 14, 31, 9, 22, 18, 29, 7, 28, 12, 35, 3, 26];
        const REDS = [1, 3, 5, 7, 9, 12, 14, 16, 18, 19, 21, 23, 25, 27, 30, 32, 34, 36];

        class Roulette {
            constructor() {
                this.canvas = document.getElementById('wheelCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.size = 600;
                this.canvas.width = this.size;
                this.canvas.height = this.size;

                this.balance = 1000;
                this.bets = {};
                this.selectedChip = 10;
                this.spinning = false;
                
                this.angle = 0;
                this.velocity = 0;
                this.ballAngle = 0;
                this.ballRadius = 220;

                this.initTable();
                this.drawWheel();
            }

            initTable() {
                const grid = document.getElementById('numbers-grid');
                for(let i=1; i<=36; i++) {
                    const div = document.createElement('div');
                    div.className = `bet-spot ${REDS.includes(i) ? 'red' : 'black'}`;
                    div.textContent = i;
                    div.onclick = () => this.placeBet(i.toString());
                    grid.appendChild(div);
                }
            }

            setChip(val) {
                this.selectedChip = val;
                document.querySelectorAll('.chip-opt').forEach(el => el.classList.remove('selected'));
                document.querySelector(`.chip-${val}`).classList.add('selected');
            }

            placeBet(spot) {
                if (this.spinning || this.balance < this.selectedChip) return;
                
                if (!this.bets[spot]) this.bets[spot] = 0;
                this.bets[spot] += this.selectedChip;
                this.balance -= this.selectedChip;
                
                this.updateUI();
            }

            clearBets() {
                if (this.spinning) return;
                Object.values(this.bets).forEach(v => this.balance += v);
                this.bets = {};
                this.updateUI();
            }

            updateUI() {
                document.getElementById('balance').textContent = this.balance;
                const totalBet = Object.values(this.bets).reduce((a,b)=>a+b, 0);
                document.getElementById('current-bet').textContent = totalBet;
                document.getElementById('spin-btn').disabled = this.spinning || totalBet === 0;
            }

            spin() {
                if (this.spinning) return;
                this.spinning = true;
                this.updateUI();
                document.getElementById('result-overlay').style.display = 'none';

                this.velocity = 0.4 + Math.random() * 0.2;
                this.ballVel = -0.2 - Math.random() * 0.1;
                this.ballRadius = 240;

                const animate = () => {
                    this.angle += this.velocity;
                    this.ballAngle += this.ballVel;
                    this.velocity *= 0.99;
                    this.ballVel *= 0.995;

                    if (Math.abs(this.ballVel) < 0.1 && this.ballRadius > 180) this.ballRadius -= 1.5;

                    if (Math.abs(this.velocity) < 0.001 && Math.abs(this.ballVel) < 0.001 && this.ballRadius <= 180) {
                        this.finishSpin();
                        return;
                    }
                    this.drawWheel();
                    requestAnimationFrame(animate);
                };
                animate();
            }

            finishSpin() {
                this.spinning = false;
                const normWheel = this.angle % (Math.PI * 2);
                const normBall = this.ballAngle % (Math.PI * 2);
                let diff = normBall - normWheel;
                if (diff < 0) diff += Math.PI * 2;
                
                const slice = (Math.PI * 2) / 37;
                const index = Math.floor(diff / slice);
                const winningNum = NUMBERS[(NUMBERS.length - index) % NUMBERS.length];
                
                this.resolveBets(winningNum);
            }

            resolveBets(num) {
                let win = 0;
                const n = parseInt(num);
                const color = n === 0 ? 'green' : (REDS.includes(n) ? 'red' : 'black');
                
                Object.entries(this.bets).forEach(([spot, amt]) => {
                    if (spot === num.toString()) win += amt * 36;
                    if (spot === 'RED' && color === 'red') win += amt * 2;
                    if (spot === 'BLACK' && color === 'black') win += amt * 2;
                    if (n !== 0) {
                        if (spot === 'EVEN' && n % 2 === 0) win += amt * 2;
                        if (spot === 'ODD' && n % 2 !== 0) win += amt * 2;
                        if (spot === '1st 12' && n <= 12) win += amt * 3;
                        if (spot === '2nd 12' && n > 12 && n <= 24) win += amt * 3;
                        if (spot === '3rd 12' && n > 24) win += amt * 3;
                    }
                });

                this.balance += win;
                this.bets = {};
                
                const ov = document.getElementById('result-overlay');
                ov.style.display = 'block';
                document.getElementById('res-num').textContent = num;
                document.getElementById('res-num').style.color = color === 'red' ? '#ef4444' : (color === 'black' ? '#fff' : '#4ade80');
                document.getElementById('res-win').textContent = win > 0 ? `YOU WON ${win}!` : "NO WIN";
                
                this.updateUI();
            }

            drawWheel() {
                const ctx = this.ctx;
                const cx = this.size / 2, cy = this.size / 2, r = 250;
                ctx.clearRect(0, 0, this.size, this.size);
                
                ctx.save();
                ctx.translate(cx, cy);
                ctx.rotate(this.angle);

                const sliceAngle = (Math.PI * 2) / 37;
                NUMBERS.forEach((num, i) => {
                    const a = i * sliceAngle;
                    ctx.beginPath(); ctx.moveTo(0, 0); ctx.arc(0, 0, r, a, a + sliceAngle);
                    ctx.fillStyle = num === 0 ? '#166534' : (REDS.includes(num) ? '#b91c1c' : '#0f172a');
                    ctx.fill(); ctx.stroke();
                    ctx.save(); ctx.rotate(a + sliceAngle/2); ctx.fillStyle = '#fff';
                    ctx.font = 'bold 16px Arial'; ctx.textAlign = 'right'; ctx.fillText(num, r - 20, 5); ctx.restore();
                });
                
                ctx.beginPath(); ctx.arc(0, 0, 100, 0, Math.PI*2); ctx.fillStyle = '#fbbf24'; ctx.fill();
                ctx.beginPath(); ctx.arc(0, 0, 80, 0, Math.PI*2); ctx.fillStyle = '#000'; ctx.fill();
                ctx.restore();

                ctx.save();
                ctx.translate(cx, cy);
                ctx.rotate(this.ballAngle);
                ctx.beginPath(); ctx.arc(this.ballRadius, 0, 8, 0, Math.PI*2);
                ctx.fillStyle = '#fff'; ctx.shadowBlur = 5; ctx.shadowColor = 'white'; ctx.fill();
                ctx.restore();
                
                ctx.fillStyle = '#fbbf24';
                ctx.beginPath(); ctx.moveTo(cx + r + 10, cy); ctx.lineTo(cx + r - 10, cy - 10); ctx.lineTo(cx + r - 10, cy + 10); ctx.fill();
            }
        }

        const game = new Roulette();
    </script>
</body>
</html>
